[Info]
name = "ogc spec"
description = "OGC tests itself :)"

[[Runner]]
name = "Test ogc core"
entry_point = ["pytest"]
tags = ['bdist', 'test']

[[Runner]]
name = "Clean up"
run = """
#!/bin/bash

rm -rf build dist ogc.egg-info
"""
tags = ['bdist', 'clean']

[[Runner]]
name = "Bump revision"
entry_point = ["punch"]
args = ["--part", "patch"]
tags = ['bdist']

[[Runner]]
name = "Build dist"
entry_point = ["python3"]
args = ["setup.py", "bdist_wheel"]
tags = ['bdist']

[[Runner]]
name = "Upload dist"
entry_point = ["twine"]
args = ["upload", "dist/*"]
tags = ['bdist']

[[Runner]]
name = "Docs"
description = """
Builds the site documentation, including a readme.
"""
entry_point = ["python3"]
args = ['tools/docgen']
tags = ['docs']

[[Runner]]
name = "Deploy"
description = """
Builds and deploys to remote server
"""
env_requires = ['WEB_SITE', 'WEB_USER', 'WEB_DST']
run = """
#!/bin/bash

set -eux
mkdocs build
rsync -avz site/* $WEB_USER@$WEB_SITE:$WEB_DST
"""
tags = ['deploy']